{"version":3,"mappings":"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","names":["w","t","n","create","save","removeCondition","i","a","$implicit","oxw","addCondition","removeAction","addAction","item","deletePromotion","constructor","super","this","name","d","enabled","couponCode","perCustomerUsageLimit","startsAt","endsAt","conditions","actions","customFields","b","A","ngOnInit","ngOnDestroy","getAvailableConditions","getConditionDefinition","getAvailableActions","getActionDefinition","saveButtonEnabled","formArrayOf","createPromotion","_","entity","relativeTo","pipe","T","x","id","subscribe","setFormValues","o","mapOperationsToInputs","code","arguments","value","e","s","addOperation","u","args","getDefaultArgValue","removeOperation","g","m","type","decls","directives","P","h","pipes","D","styles","changeDetection","filter","F","L","U","dialog","title","buttons","M","I","createQueryOptions","contains","options","skip","take","f","__typename","createdAt","updatedAt","p","factory","token","breadcrumb","y","E","path","component","data","resolve","canDeactivate","breadcrumbKey","getName","route","v","imports"],"sources":["webpack:///node_modules/@vendure/admin-ui/__ivy_ngcc__/fesm2015/vendure-admin-ui-marketing.js"],"sourcesContent":["import * as i0 from '@angular/core';\nimport { Component, ChangeDetectionStrategy, ChangeDetectorRef, Injectable, NgModule } from '@angular/core';\nimport { Validators, FormBuilder, FormGroup, FormControl } from '@angular/forms';\nimport * as i1 from '@angular/router';\nimport { Router, ActivatedRoute, RouterModule } from '@angular/router';\nimport { marker } from '@biesbjerg/ngx-translate-extract-marker';\nimport * as i2 from '@vendure/admin-ui/core';\nimport { BaseDetailComponent, encodeConfigArgValue, getConfigArgValue, getDefaultConfigArgValue, ServerConfigService, DataService, NotificationService, BaseListComponent, ModalService, BaseEntityResolver, createResolveData, CanDeactivateDetailGuard, detailBreadcrumb, SharedModule } from '@vendure/admin-ui/core';\nimport { take, mergeMap, debounceTime, takeUntil, switchMap } from 'rxjs/operators';\nimport { merge, EMPTY } from 'rxjs';\n\nimport * as ɵngcc0 from '@angular/core';\nimport * as ɵngcc1 from '@angular/router';\nimport * as ɵngcc2 from '@vendure/admin-ui/core';\nimport * as ɵngcc3 from '@angular/forms';\nimport * as ɵngcc4 from '@angular/common';\nimport * as ɵngcc5 from '@clr/angular';\nimport * as ɵngcc6 from '@ngx-translate/core';\n\nconst _c0 = function () { return [\"enabled\"]; };\nfunction PromotionDetailComponent_clr_toggle_wrapper_5_Template(rf, ctx) { if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"clr-toggle-wrapper\");\n    ɵngcc0.ɵɵelement(1, \"input\", 25);\n    ɵngcc0.ɵɵelementStart(2, \"label\");\n    ɵngcc0.ɵɵtext(3);\n    ɵngcc0.ɵɵpipe(4, \"translate\");\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementEnd();\n} if (rf & 2) {\n    const ctx_r0 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"formControl\", ctx_r0.detailForm.get(ɵngcc0.ɵɵpureFunction0(4, _c0)));\n    ɵngcc0.ɵɵadvance(2);\n    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(4, 2, \"common.enabled\"));\n} }\nfunction PromotionDetailComponent_button_8_Template(rf, ctx) { if (rf & 1) {\n    const _r10 = ɵngcc0.ɵɵgetCurrentView();\n    ɵngcc0.ɵɵelementStart(0, \"button\", 26);\n    ɵngcc0.ɵɵlistener(\"click\", function PromotionDetailComponent_button_8_Template_button_click_0_listener() { ɵngcc0.ɵɵrestoreView(_r10); const ctx_r9 = ɵngcc0.ɵɵnextContext(); return ctx_r9.create(); });\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵpipe(2, \"translate\");\n    ɵngcc0.ɵɵelementEnd();\n} if (rf & 2) {\n    const ctx_r1 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵproperty(\"disabled\", !ctx_r1.saveButtonEnabled());\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate1(\" \", ɵngcc0.ɵɵpipeBind1(2, 2, \"common.create\"), \" \");\n} }\nfunction PromotionDetailComponent_ng_template_10_button_0_Template(rf, ctx) { if (rf & 1) {\n    const _r13 = ɵngcc0.ɵɵgetCurrentView();\n    ɵngcc0.ɵɵelementStart(0, \"button\", 26);\n    ɵngcc0.ɵɵlistener(\"click\", function PromotionDetailComponent_ng_template_10_button_0_Template_button_click_0_listener() { ɵngcc0.ɵɵrestoreView(_r13); const ctx_r12 = ɵngcc0.ɵɵnextContext(2); return ctx_r12.save(); });\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵpipe(2, \"translate\");\n    ɵngcc0.ɵɵelementEnd();\n} if (rf & 2) {\n    const ctx_r11 = ɵngcc0.ɵɵnextContext(2);\n    ɵngcc0.ɵɵproperty(\"disabled\", !ctx_r11.saveButtonEnabled());\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate1(\" \", ɵngcc0.ɵɵpipeBind1(2, 2, \"common.update\"), \" \");\n} }\nfunction PromotionDetailComponent_ng_template_10_Template(rf, ctx) { if (rf & 1) {\n    ɵngcc0.ɵɵtemplate(0, PromotionDetailComponent_ng_template_10_button_0_Template, 3, 4, \"button\", 27);\n} if (rf & 2) {\n    ɵngcc0.ɵɵproperty(\"vdrIfPermissions\", \"UpdatePromotion\");\n} }\nfunction PromotionDetailComponent_section_31_Template(rf, ctx) { if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"section\", 28);\n    ɵngcc0.ɵɵelementStart(1, \"label\");\n    ɵngcc0.ɵɵtext(2);\n    ɵngcc0.ɵɵpipe(3, \"translate\");\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelement(4, \"vdr-tabbed-custom-fields\", 29);\n    ɵngcc0.ɵɵpipe(5, \"hasPermission\");\n    ɵngcc0.ɵɵelementEnd();\n} if (rf & 2) {\n    const ctx_r4 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(2);\n    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(3, 4, \"common.custom-fields\"));\n    ɵngcc0.ɵɵadvance(2);\n    ɵngcc0.ɵɵproperty(\"customFields\", ctx_r4.customFields)(\"customFieldsFormGroup\", ctx_r4.detailForm.get(\"customFields\"))(\"readonly\", !ɵngcc0.ɵɵpipeBind1(5, 6, \"UpdatePromotion\"));\n} }\nfunction PromotionDetailComponent_ng_container_38_Template(rf, ctx) { if (rf & 1) {\n    const _r17 = ɵngcc0.ɵɵgetCurrentView();\n    ɵngcc0.ɵɵelementContainerStart(0);\n    ɵngcc0.ɵɵelementStart(1, \"vdr-configurable-input\", 30);\n    ɵngcc0.ɵɵlistener(\"remove\", function PromotionDetailComponent_ng_container_38_Template_vdr_configurable_input_remove_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r17); const ctx_r16 = ɵngcc0.ɵɵnextContext(); return ctx_r16.removeCondition($event); });\n    ɵngcc0.ɵɵpipe(2, \"hasPermission\");\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementContainerEnd();\n} if (rf & 2) {\n    const condition_r14 = ctx.$implicit;\n    const i_r15 = ctx.index;\n    const ctx_r5 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"position\", i_r15)(\"readonly\", !ɵngcc0.ɵɵpipeBind1(2, 5, \"UpdatePromotion\"))(\"operation\", condition_r14)(\"operationDefinition\", ctx_r5.getConditionDefinition(condition_r14))(\"formControlName\", i_r15);\n} }\nfunction PromotionDetailComponent_vdr_dropdown_40_button_6_Template(rf, ctx) { if (rf & 1) {\n    const _r21 = ɵngcc0.ɵɵgetCurrentView();\n    ɵngcc0.ɵɵelementStart(0, \"button\", 35);\n    ɵngcc0.ɵɵlistener(\"click\", function PromotionDetailComponent_vdr_dropdown_40_button_6_Template_button_click_0_listener() { const restoredCtx = ɵngcc0.ɵɵrestoreView(_r21); const condition_r19 = restoredCtx.$implicit; const ctx_r20 = ɵngcc0.ɵɵnextContext(2); return ctx_r20.addCondition(condition_r19); });\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵelementEnd();\n} if (rf & 2) {\n    const condition_r19 = ctx.$implicit;\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate1(\" \", condition_r19.description, \" \");\n} }\nfunction PromotionDetailComponent_vdr_dropdown_40_Template(rf, ctx) { if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"vdr-dropdown\");\n    ɵngcc0.ɵɵelementStart(1, \"button\", 31);\n    ɵngcc0.ɵɵelement(2, \"clr-icon\", 32);\n    ɵngcc0.ɵɵtext(3);\n    ɵngcc0.ɵɵpipe(4, \"translate\");\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementStart(5, \"vdr-dropdown-menu\", 33);\n    ɵngcc0.ɵɵtemplate(6, PromotionDetailComponent_vdr_dropdown_40_button_6_Template, 2, 1, \"button\", 34);\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementEnd();\n} if (rf & 2) {\n    const ctx_r6 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(3);\n    ɵngcc0.ɵɵtextInterpolate1(\" \", ɵngcc0.ɵɵpipeBind1(4, 2, \"marketing.add-condition\"), \" \");\n    ɵngcc0.ɵɵadvance(3);\n    ɵngcc0.ɵɵproperty(\"ngForOf\", ctx_r6.getAvailableConditions());\n} }\nfunction PromotionDetailComponent_vdr_configurable_input_45_Template(rf, ctx) { if (rf & 1) {\n    const _r25 = ɵngcc0.ɵɵgetCurrentView();\n    ɵngcc0.ɵɵelementStart(0, \"vdr-configurable-input\", 36);\n    ɵngcc0.ɵɵlistener(\"remove\", function PromotionDetailComponent_vdr_configurable_input_45_Template_vdr_configurable_input_remove_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r25); const ctx_r24 = ɵngcc0.ɵɵnextContext(); return ctx_r24.removeAction($event); });\n    ɵngcc0.ɵɵpipe(1, \"hasPermission\");\n    ɵngcc0.ɵɵelementEnd();\n} if (rf & 2) {\n    const action_r22 = ctx.$implicit;\n    const i_r23 = ctx.index;\n    const ctx_r7 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵproperty(\"position\", i_r23)(\"operation\", action_r22)(\"readonly\", !ɵngcc0.ɵɵpipeBind1(1, 5, \"UpdatePromotion\"))(\"operationDefinition\", ctx_r7.getActionDefinition(action_r22))(\"formControlName\", i_r23);\n} }\nfunction PromotionDetailComponent_vdr_dropdown_47_button_6_Template(rf, ctx) { if (rf & 1) {\n    const _r29 = ɵngcc0.ɵɵgetCurrentView();\n    ɵngcc0.ɵɵelementStart(0, \"button\", 35);\n    ɵngcc0.ɵɵlistener(\"click\", function PromotionDetailComponent_vdr_dropdown_47_button_6_Template_button_click_0_listener() { const restoredCtx = ɵngcc0.ɵɵrestoreView(_r29); const action_r27 = restoredCtx.$implicit; const ctx_r28 = ɵngcc0.ɵɵnextContext(2); return ctx_r28.addAction(action_r27); });\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵelementEnd();\n} if (rf & 2) {\n    const action_r27 = ctx.$implicit;\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate1(\" \", action_r27.description, \" \");\n} }\nfunction PromotionDetailComponent_vdr_dropdown_47_Template(rf, ctx) { if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"vdr-dropdown\");\n    ɵngcc0.ɵɵelementStart(1, \"button\", 31);\n    ɵngcc0.ɵɵelement(2, \"clr-icon\", 32);\n    ɵngcc0.ɵɵtext(3);\n    ɵngcc0.ɵɵpipe(4, \"translate\");\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementStart(5, \"vdr-dropdown-menu\", 33);\n    ɵngcc0.ɵɵtemplate(6, PromotionDetailComponent_vdr_dropdown_47_button_6_Template, 2, 1, \"button\", 34);\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementEnd();\n} if (rf & 2) {\n    const ctx_r8 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(3);\n    ɵngcc0.ɵɵtextInterpolate1(\" \", ɵngcc0.ɵɵpipeBind1(4, 2, \"marketing.add-action\"), \" \");\n    ɵngcc0.ɵɵadvance(3);\n    ɵngcc0.ɵɵproperty(\"ngForOf\", ctx_r8.getAvailableActions());\n} }\nconst _c1 = function () { return [\"./create\"]; };\nfunction PromotionListComponent_a_9_Template(rf, ctx) { if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"a\", 6);\n    ɵngcc0.ɵɵelement(1, \"clr-icon\", 7);\n    ɵngcc0.ɵɵtext(2);\n    ɵngcc0.ɵɵpipe(3, \"translate\");\n    ɵngcc0.ɵɵelementEnd();\n} if (rf & 2) {\n    ɵngcc0.ɵɵproperty(\"routerLink\", ɵngcc0.ɵɵpureFunction0(4, _c1));\n    ɵngcc0.ɵɵadvance(2);\n    ɵngcc0.ɵɵtextInterpolate1(\" \", ɵngcc0.ɵɵpipeBind1(3, 2, \"marketing.create-new-promotion\"), \" \");\n} }\nfunction PromotionListComponent_ng_template_30_vdr_chip_3_Template(rf, ctx) { if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"vdr-chip\");\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵelementEnd();\n} if (rf & 2) {\n    const promotion_r2 = ɵngcc0.ɵɵnextContext().item;\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate1(\" \", promotion_r2.couponCode, \" \");\n} }\nfunction PromotionListComponent_ng_template_30_vdr_chip_11_Template(rf, ctx) { if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"vdr-chip\");\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵpipe(2, \"translate\");\n    ɵngcc0.ɵɵelementEnd();\n} if (rf & 2) {\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(2, 1, \"common.disabled\"));\n} }\nconst _c2 = function (a1) { return [\"./\", a1]; };\nfunction PromotionListComponent_ng_template_30_Template(rf, ctx) { if (rf & 1) {\n    const _r7 = ɵngcc0.ɵɵgetCurrentView();\n    ɵngcc0.ɵɵelementStart(0, \"td\", 8);\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementStart(2, \"td\", 8);\n    ɵngcc0.ɵɵtemplate(3, PromotionListComponent_ng_template_30_vdr_chip_3_Template, 2, 1, \"vdr-chip\", 9);\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementStart(4, \"td\", 8);\n    ɵngcc0.ɵɵtext(5);\n    ɵngcc0.ɵɵpipe(6, \"localeDate\");\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementStart(7, \"td\", 8);\n    ɵngcc0.ɵɵtext(8);\n    ɵngcc0.ɵɵpipe(9, \"localeDate\");\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementStart(10, \"td\", 10);\n    ɵngcc0.ɵɵtemplate(11, PromotionListComponent_ng_template_30_vdr_chip_11_Template, 3, 3, \"vdr-chip\", 9);\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementStart(12, \"td\", 11);\n    ɵngcc0.ɵɵelement(13, \"vdr-table-row-action\", 12);\n    ɵngcc0.ɵɵpipe(14, \"translate\");\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementStart(15, \"td\", 11);\n    ɵngcc0.ɵɵelementStart(16, \"vdr-dropdown\");\n    ɵngcc0.ɵɵelementStart(17, \"button\", 13);\n    ɵngcc0.ɵɵtext(18);\n    ɵngcc0.ɵɵpipe(19, \"translate\");\n    ɵngcc0.ɵɵelement(20, \"clr-icon\", 14);\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementStart(21, \"vdr-dropdown-menu\", 15);\n    ɵngcc0.ɵɵelementStart(22, \"button\", 16);\n    ɵngcc0.ɵɵlistener(\"click\", function PromotionListComponent_ng_template_30_Template_button_click_22_listener() { const restoredCtx = ɵngcc0.ɵɵrestoreView(_r7); const promotion_r2 = restoredCtx.item; const ctx_r6 = ɵngcc0.ɵɵnextContext(); return ctx_r6.deletePromotion(promotion_r2.id); });\n    ɵngcc0.ɵɵpipe(23, \"hasPermission\");\n    ɵngcc0.ɵɵelement(24, \"clr-icon\", 17);\n    ɵngcc0.ɵɵtext(25);\n    ɵngcc0.ɵɵpipe(26, \"translate\");\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementEnd();\n} if (rf & 2) {\n    const promotion_r2 = ctx.item;\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate(promotion_r2.name);\n    ɵngcc0.ɵɵadvance(2);\n    ɵngcc0.ɵɵproperty(\"ngIf\", promotion_r2.couponCode);\n    ɵngcc0.ɵɵadvance(2);\n    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind2(6, 10, promotion_r2.startsAt, \"longDate\"));\n    ɵngcc0.ɵɵadvance(3);\n    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind2(9, 13, promotion_r2.endsAt, \"longDate\"));\n    ɵngcc0.ɵɵadvance(3);\n    ɵngcc0.ɵɵproperty(\"ngIf\", !promotion_r2.enabled);\n    ɵngcc0.ɵɵadvance(2);\n    ɵngcc0.ɵɵproperty(\"label\", ɵngcc0.ɵɵpipeBind1(14, 16, \"common.edit\"))(\"linkTo\", ɵngcc0.ɵɵpureFunction1(24, _c2, promotion_r2.id));\n    ɵngcc0.ɵɵadvance(5);\n    ɵngcc0.ɵɵtextInterpolate1(\" \", ɵngcc0.ɵɵpipeBind1(19, 18, \"common.actions\"), \" \");\n    ɵngcc0.ɵɵadvance(4);\n    ɵngcc0.ɵɵproperty(\"disabled\", !ɵngcc0.ɵɵpipeBind1(23, 20, \"DeletePromotion\"));\n    ɵngcc0.ɵɵadvance(3);\n    ɵngcc0.ɵɵtextInterpolate1(\" \", ɵngcc0.ɵɵpipeBind1(26, 22, \"common.delete\"), \" \");\n} }\nclass PromotionDetailComponent extends BaseDetailComponent {\r\n    constructor(router, route, serverConfigService, changeDetector, dataService, formBuilder, notificationService) {\r\n        super(route, router, serverConfigService, dataService);\r\n        this.changeDetector = changeDetector;\r\n        this.dataService = dataService;\r\n        this.formBuilder = formBuilder;\r\n        this.notificationService = notificationService;\r\n        this.conditions = [];\r\n        this.actions = [];\r\n        this.allConditions = [];\r\n        this.allActions = [];\r\n        this.customFields = this.getCustomFieldConfig('Promotion');\r\n        this.detailForm = this.formBuilder.group({\r\n            name: ['', Validators.required],\r\n            enabled: true,\r\n            couponCode: null,\r\n            perCustomerUsageLimit: null,\r\n            startsAt: null,\r\n            endsAt: null,\r\n            conditions: this.formBuilder.array([]),\r\n            actions: this.formBuilder.array([]),\r\n            customFields: this.formBuilder.group(this.customFields.reduce((hash, field) => (Object.assign(Object.assign({}, hash), { [field.name]: '' })), {})),\r\n        });\r\n    }\r\n    ngOnInit() {\r\n        this.init();\r\n        this.promotion$ = this.entity$;\r\n        this.dataService.promotion.getPromotionActionsAndConditions().single$.subscribe(data => {\r\n            this.allActions = data.promotionActions;\r\n            this.allConditions = data.promotionConditions;\r\n            this.changeDetector.markForCheck();\r\n        });\r\n    }\r\n    ngOnDestroy() {\r\n        this.destroy();\r\n    }\r\n    getAvailableConditions() {\r\n        return this.allConditions.filter(o => !this.conditions.find(c => c.code === o.code));\r\n    }\r\n    getConditionDefinition(condition) {\r\n        return this.allConditions.find(c => c.code === condition.code);\r\n    }\r\n    getAvailableActions() {\r\n        return this.allActions.filter(o => !this.actions.find(a => a.code === o.code));\r\n    }\r\n    getActionDefinition(action) {\r\n        return this.allActions.find(c => c.code === action.code);\r\n    }\r\n    saveButtonEnabled() {\r\n        return (this.detailForm.dirty &&\r\n            this.detailForm.valid &&\r\n            (this.conditions.length !== 0 || this.detailForm.value.couponCode) &&\r\n            this.actions.length !== 0);\r\n    }\r\n    addCondition(condition) {\r\n        this.addOperation('conditions', condition);\r\n        this.detailForm.markAsDirty();\r\n    }\r\n    addAction(action) {\r\n        this.addOperation('actions', action);\r\n        this.detailForm.markAsDirty();\r\n    }\r\n    removeCondition(condition) {\r\n        this.removeOperation('conditions', condition);\r\n        this.detailForm.markAsDirty();\r\n    }\r\n    removeAction(action) {\r\n        this.removeOperation('actions', action);\r\n        this.detailForm.markAsDirty();\r\n    }\r\n    formArrayOf(key) {\r\n        return this.detailForm.get(key);\r\n    }\r\n    create() {\r\n        if (!this.detailForm.dirty) {\r\n            return;\r\n        }\r\n        const formValue = this.detailForm.value;\r\n        const input = {\r\n            name: formValue.name,\r\n            enabled: true,\r\n            couponCode: formValue.couponCode,\r\n            perCustomerUsageLimit: formValue.perCustomerUsageLimit,\r\n            startsAt: formValue.startsAt,\r\n            endsAt: formValue.endsAt,\r\n            conditions: this.mapOperationsToInputs(this.conditions, formValue.conditions),\r\n            actions: this.mapOperationsToInputs(this.actions, formValue.actions),\r\n            customFields: formValue.customFields,\r\n        };\r\n        this.dataService.promotion.createPromotion(input).subscribe(({ createPromotion }) => {\r\n            switch (createPromotion.__typename) {\r\n                case 'Promotion':\r\n                    this.notificationService.success(marker('common.notify-create-success'), {\r\n                        entity: 'Promotion',\r\n                    });\r\n                    this.detailForm.markAsPristine();\r\n                    this.changeDetector.markForCheck();\r\n                    this.router.navigate(['../', createPromotion.id], { relativeTo: this.route });\r\n                    break;\r\n                case 'MissingConditionsError':\r\n                    this.notificationService.error(createPromotion.message);\r\n                    break;\r\n            }\r\n        }, err => {\r\n            this.notificationService.error(marker('common.notify-create-error'), {\r\n                entity: 'Promotion',\r\n            });\r\n        });\r\n    }\r\n    save() {\r\n        if (!this.detailForm.dirty) {\r\n            return;\r\n        }\r\n        const formValue = this.detailForm.value;\r\n        this.promotion$\r\n            .pipe(take(1), mergeMap(promotion => {\r\n            const input = {\r\n                id: promotion.id,\r\n                name: formValue.name,\r\n                enabled: formValue.enabled,\r\n                couponCode: formValue.couponCode,\r\n                perCustomerUsageLimit: formValue.perCustomerUsageLimit,\r\n                startsAt: formValue.startsAt,\r\n                endsAt: formValue.endsAt,\r\n                conditions: this.mapOperationsToInputs(this.conditions, formValue.conditions),\r\n                actions: this.mapOperationsToInputs(this.actions, formValue.actions),\r\n                customFields: formValue.customFields,\r\n            };\r\n            return this.dataService.promotion.updatePromotion(input);\r\n        }))\r\n            .subscribe(data => {\r\n            this.notificationService.success(marker('common.notify-update-success'), {\r\n                entity: 'Promotion',\r\n            });\r\n            this.detailForm.markAsPristine();\r\n            this.changeDetector.markForCheck();\r\n        }, err => {\r\n            this.notificationService.error(marker('common.notify-update-error'), {\r\n                entity: 'Promotion',\r\n            });\r\n        });\r\n    }\r\n    /**\r\n     * Update the form values when the entity changes.\r\n     */\r\n    setFormValues(entity, languageCode) {\r\n        this.detailForm.patchValue({\r\n            name: entity.name,\r\n            enabled: entity.enabled,\r\n            couponCode: entity.couponCode,\r\n            perCustomerUsageLimit: entity.perCustomerUsageLimit,\r\n            startsAt: entity.startsAt,\r\n            endsAt: entity.endsAt,\r\n        });\r\n        entity.conditions.forEach(o => {\r\n            this.addOperation('conditions', o);\r\n        });\r\n        entity.actions.forEach(o => this.addOperation('actions', o));\r\n        if (this.customFields.length) {\r\n            this.setCustomFieldFormValues(this.customFields, this.detailForm.get('customFields'), entity);\r\n        }\r\n    }\r\n    /**\r\n     * Maps an array of conditions or actions to the input format expected by the GraphQL API.\r\n     */\r\n    mapOperationsToInputs(operations, formValueOperations) {\r\n        return operations.map((o, i) => {\r\n            return {\r\n                code: o.code,\r\n                arguments: Object.values(formValueOperations[i].args).map((value, j) => ({\r\n                    name: o.args[j].name,\r\n                    value: encodeConfigArgValue(value),\r\n                })),\r\n            };\r\n        });\r\n    }\r\n    /**\r\n     * Adds a new condition or action to the promotion.\r\n     */\r\n    addOperation(key, operation) {\r\n        const operationsArray = this.formArrayOf(key);\r\n        const collection = key === 'conditions' ? this.conditions : this.actions;\r\n        const index = operationsArray.value.findIndex(o => o.code === operation.code);\r\n        if (index === -1) {\r\n            const argsHash = operation.args.reduce((output, arg) => {\r\n                var _a;\r\n                return (Object.assign(Object.assign({}, output), { [arg.name]: (_a = getConfigArgValue(arg.value)) !== null && _a !== void 0 ? _a : this.getDefaultArgValue(key, operation, arg.name) }));\r\n            }, {});\r\n            operationsArray.push(this.formBuilder.control({\r\n                code: operation.code,\r\n                args: argsHash,\r\n            }));\r\n            collection.push({\r\n                code: operation.code,\r\n                args: operation.args.map(a => ({ name: a.name, value: getConfigArgValue(a.value) })),\r\n            });\r\n        }\r\n    }\r\n    getDefaultArgValue(key, operation, argName) {\r\n        const def = key === 'conditions'\r\n            ? this.allConditions.find(c => c.code === operation.code)\r\n            : this.allActions.find(a => a.code === operation.code);\r\n        if (def) {\r\n            const argDef = def.args.find(a => a.name === argName);\r\n            if (argDef) {\r\n                return getDefaultConfigArgValue(argDef);\r\n            }\r\n        }\r\n        throw new Error(`Could not determine default value for \"argName\"`);\r\n    }\r\n    /**\r\n     * Removes a condition or action from the promotion.\r\n     */\r\n    removeOperation(key, operation) {\r\n        const operationsArray = this.formArrayOf(key);\r\n        const collection = key === 'conditions' ? this.conditions : this.actions;\r\n        const index = operationsArray.value.findIndex(o => o.code === operation.code);\r\n        if (index !== -1) {\r\n            operationsArray.removeAt(index);\r\n            collection.splice(index, 1);\r\n        }\r\n    }\r\n}\nPromotionDetailComponent.ɵfac = function PromotionDetailComponent_Factory(t) { return new (t || PromotionDetailComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.Router), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.ActivatedRoute), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.ServerConfigService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.DataService), ɵngcc0.ɵɵdirectiveInject(ɵngcc3.FormBuilder), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.NotificationService)); };\nPromotionDetailComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: PromotionDetailComponent, selectors: [[\"vdr-promotion-detail\"]], features: [ɵngcc0.ɵɵInheritDefinitionFeature], decls: 48, vars: 46, consts: [[1, \"flex\", \"clr-align-items-center\"], [3, \"entity\"], [4, \"vdrIfPermissions\"], [\"locationId\", \"promotion-detail\"], [\"class\", \"btn btn-primary\", 3, \"disabled\", \"click\", 4, \"ngIf\", \"ngIfElse\"], [\"updateButton\", \"\"], [1, \"form\", 3, \"formGroup\"], [\"for\", \"name\", 3, \"label\"], [\"id\", \"name\", \"type\", \"text\", \"formControlName\", \"name\", 3, \"readonly\"], [\"for\", \"startsAt\", 3, \"label\"], [\"formControlName\", \"startsAt\"], [\"for\", \"endsAt\", 3, \"label\"], [\"formControlName\", \"endsAt\"], [\"for\", \"couponCode\", 3, \"label\"], [\"id\", \"couponCode\", \"type\", \"text\", \"formControlName\", \"couponCode\", 3, \"readonly\"], [\"for\", \"perCustomerUsageLimit\", 3, \"label\"], [\"id\", \"perCustomerUsageLimit\", \"type\", \"number\", \"min\", \"1\", \"max\", \"999\", \"formControlName\", \"perCustomerUsageLimit\", 3, \"readonly\"], [\"formGroupName\", \"customFields\", 4, \"ngIf\"], [\"locationId\", \"promotion-detail\", 3, \"entity$\", \"detailForm\"], [1, \"clr-row\"], [\"formArrayName\", \"conditions\", 1, \"clr-col\"], [1, \"clr-control-label\"], [4, \"ngFor\", \"ngForOf\"], [\"formArrayName\", \"actions\", 1, \"clr-col\"], [3, \"position\", \"operation\", \"readonly\", \"operationDefinition\", \"formControlName\", \"remove\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"checkbox\", \"clrToggle\", \"\", \"name\", \"enabled\", 3, \"formControl\"], [1, \"btn\", \"btn-primary\", 3, \"disabled\", \"click\"], [\"class\", \"btn btn-primary\", 3, \"disabled\", \"click\", 4, \"vdrIfPermissions\"], [\"formGroupName\", \"customFields\"], [\"entityName\", \"Promotion\", 3, \"customFields\", \"customFieldsFormGroup\", \"readonly\"], [3, \"position\", \"readonly\", \"operation\", \"operationDefinition\", \"formControlName\", \"remove\"], [\"vdrDropdownTrigger\", \"\", 1, \"btn\", \"btn-outline\"], [\"shape\", \"plus\"], [\"vdrPosition\", \"bottom-left\"], [\"type\", \"button\", \"vdrDropdownItem\", \"\", \"class\", \"item-wrap\", 3, \"click\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"button\", \"vdrDropdownItem\", \"\", 1, \"item-wrap\", 3, \"click\"], [3, \"position\", \"operation\", \"readonly\", \"operationDefinition\", \"formControlName\", \"remove\"]], template: function PromotionDetailComponent_Template(rf, ctx) { if (rf & 1) {\n        ɵngcc0.ɵɵelementStart(0, \"vdr-action-bar\");\n        ɵngcc0.ɵɵelementStart(1, \"vdr-ab-left\");\n        ɵngcc0.ɵɵelementStart(2, \"div\", 0);\n        ɵngcc0.ɵɵelement(3, \"vdr-entity-info\", 1);\n        ɵngcc0.ɵɵpipe(4, \"async\");\n        ɵngcc0.ɵɵtemplate(5, PromotionDetailComponent_clr_toggle_wrapper_5_Template, 5, 5, \"clr-toggle-wrapper\", 2);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(6, \"vdr-ab-right\");\n        ɵngcc0.ɵɵelement(7, \"vdr-action-bar-items\", 3);\n        ɵngcc0.ɵɵtemplate(8, PromotionDetailComponent_button_8_Template, 3, 4, \"button\", 4);\n        ɵngcc0.ɵɵpipe(9, \"async\");\n        ɵngcc0.ɵɵtemplate(10, PromotionDetailComponent_ng_template_10_Template, 1, 1, \"ng-template\", null, 5, ɵngcc0.ɵɵtemplateRefExtractor);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(12, \"form\", 6);\n        ɵngcc0.ɵɵelementStart(13, \"vdr-form-field\", 7);\n        ɵngcc0.ɵɵpipe(14, \"translate\");\n        ɵngcc0.ɵɵelement(15, \"input\", 8);\n        ɵngcc0.ɵɵpipe(16, \"hasPermission\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(17, \"vdr-form-field\", 9);\n        ɵngcc0.ɵɵpipe(18, \"translate\");\n        ɵngcc0.ɵɵelement(19, \"vdr-datetime-picker\", 10);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(20, \"vdr-form-field\", 11);\n        ɵngcc0.ɵɵpipe(21, \"translate\");\n        ɵngcc0.ɵɵelement(22, \"vdr-datetime-picker\", 12);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(23, \"vdr-form-field\", 13);\n        ɵngcc0.ɵɵpipe(24, \"translate\");\n        ɵngcc0.ɵɵelement(25, \"input\", 14);\n        ɵngcc0.ɵɵpipe(26, \"hasPermission\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(27, \"vdr-form-field\", 15);\n        ɵngcc0.ɵɵpipe(28, \"translate\");\n        ɵngcc0.ɵɵelement(29, \"input\", 16);\n        ɵngcc0.ɵɵpipe(30, \"hasPermission\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵtemplate(31, PromotionDetailComponent_section_31_Template, 6, 8, \"section\", 17);\n        ɵngcc0.ɵɵelement(32, \"vdr-custom-detail-component-host\", 18);\n        ɵngcc0.ɵɵelementStart(33, \"div\", 19);\n        ɵngcc0.ɵɵelementStart(34, \"div\", 20);\n        ɵngcc0.ɵɵelementStart(35, \"label\", 21);\n        ɵngcc0.ɵɵtext(36);\n        ɵngcc0.ɵɵpipe(37, \"translate\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵtemplate(38, PromotionDetailComponent_ng_container_38_Template, 3, 7, \"ng-container\", 22);\n        ɵngcc0.ɵɵelementStart(39, \"div\");\n        ɵngcc0.ɵɵtemplate(40, PromotionDetailComponent_vdr_dropdown_40_Template, 7, 4, \"vdr-dropdown\", 2);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(41, \"div\", 23);\n        ɵngcc0.ɵɵelementStart(42, \"label\", 21);\n        ɵngcc0.ɵɵtext(43);\n        ɵngcc0.ɵɵpipe(44, \"translate\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵtemplate(45, PromotionDetailComponent_vdr_configurable_input_45_Template, 2, 7, \"vdr-configurable-input\", 24);\n        ɵngcc0.ɵɵelementStart(46, \"div\");\n        ɵngcc0.ɵɵtemplate(47, PromotionDetailComponent_vdr_dropdown_47_Template, 7, 4, \"vdr-dropdown\", 2);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n    } if (rf & 2) {\n        const _r2 = ɵngcc0.ɵɵreference(11);\n        ɵngcc0.ɵɵadvance(3);\n        ɵngcc0.ɵɵproperty(\"entity\", ɵngcc0.ɵɵpipeBind1(4, 22, ctx.entity$));\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"vdrIfPermissions\", \"UpdatePromotion\");\n        ɵngcc0.ɵɵadvance(3);\n        ɵngcc0.ɵɵproperty(\"ngIf\", ɵngcc0.ɵɵpipeBind1(9, 24, ctx.isNew$))(\"ngIfElse\", _r2);\n        ɵngcc0.ɵɵadvance(4);\n        ɵngcc0.ɵɵproperty(\"formGroup\", ctx.detailForm);\n        ɵngcc0.ɵɵadvance(1);\n        ɵngcc0.ɵɵproperty(\"label\", ɵngcc0.ɵɵpipeBind1(14, 26, \"common.name\"));\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"readonly\", !ɵngcc0.ɵɵpipeBind1(16, 28, \"UpdatePromotion\"));\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"label\", ɵngcc0.ɵɵpipeBind1(18, 30, \"marketing.starts-at\"));\n        ɵngcc0.ɵɵadvance(3);\n        ɵngcc0.ɵɵproperty(\"label\", ɵngcc0.ɵɵpipeBind1(21, 32, \"marketing.ends-at\"));\n        ɵngcc0.ɵɵadvance(3);\n        ɵngcc0.ɵɵproperty(\"label\", ɵngcc0.ɵɵpipeBind1(24, 34, \"marketing.coupon-code\"));\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"readonly\", !ɵngcc0.ɵɵpipeBind1(26, 36, \"UpdatePromotion\"));\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"label\", ɵngcc0.ɵɵpipeBind1(28, 38, \"marketing.per-customer-limit\"));\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"readonly\", !ɵngcc0.ɵɵpipeBind1(30, 40, \"UpdatePromotion\"));\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"ngIf\", ctx.customFields.length);\n        ɵngcc0.ɵɵadvance(1);\n        ɵngcc0.ɵɵproperty(\"entity$\", ctx.entity$)(\"detailForm\", ctx.detailForm);\n        ɵngcc0.ɵɵadvance(4);\n        ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(37, 42, \"marketing.conditions\"));\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"ngForOf\", ctx.conditions);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"vdrIfPermissions\", \"UpdatePromotion\");\n        ɵngcc0.ɵɵadvance(3);\n        ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(44, 44, \"marketing.actions\"));\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"ngForOf\", ctx.actions);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"vdrIfPermissions\", \"UpdatePromotion\");\n    } }, directives: [ɵngcc2.ActionBarComponent, ɵngcc2.ActionBarLeftComponent, ɵngcc2.EntityInfoComponent, ɵngcc2.IfPermissionsDirective, ɵngcc2.ActionBarRightComponent, ɵngcc2.ActionBarItemsComponent, ɵngcc4.NgIf, ɵngcc3.ɵNgNoValidate, ɵngcc3.NgControlStatusGroup, ɵngcc3.FormGroupDirective, ɵngcc2.FormFieldComponent, ɵngcc2.FormFieldControlDirective, ɵngcc3.DefaultValueAccessor, ɵngcc3.NgControlStatus, ɵngcc3.FormControlName, ɵngcc2.DatetimePickerComponent, ɵngcc3.MinValidator, ɵngcc3.MaxValidator, ɵngcc3.NumberValueAccessor, ɵngcc2.CustomDetailComponentHostComponent, ɵngcc3.FormArrayName, ɵngcc5.ClrLabel, ɵngcc4.NgForOf, ɵngcc5.ClrCheckboxWrapper, ɵngcc3.CheckboxControlValueAccessor, ɵngcc5.ClrCheckbox, ɵngcc3.FormControlDirective, ɵngcc3.FormGroupName, ɵngcc2.TabbedCustomFieldsComponent, ɵngcc2.ConfigurableInputComponent, ɵngcc2.DropdownComponent, ɵngcc2.DropdownTriggerDirective, ɵngcc5.ClrIconCustomTag, ɵngcc2.DropdownMenuComponent, ɵngcc2.DropdownItemDirective], pipes: [ɵngcc4.AsyncPipe, ɵngcc6.TranslatePipe, ɵngcc2.HasPermissionPipe], styles: [\".item-wrap[_ngcontent-%COMP%]{white-space:normal}\"], changeDetection: 0 });\r\nPromotionDetailComponent.ctorParameters = () => [\r\n    { type: Router },\r\n    { type: ActivatedRoute },\r\n    { type: ServerConfigService },\r\n    { type: ChangeDetectorRef },\r\n    { type: DataService },\r\n    { type: FormBuilder },\r\n    { type: NotificationService }\r\n];\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(PromotionDetailComponent, [{\n        type: Component,\n        args: [{\n                selector: 'vdr-promotion-detail',\n                template: \"<vdr-action-bar>\\r\\n    <vdr-ab-left>\\r\\n        <div class=\\\"flex clr-align-items-center\\\">\\r\\n            <vdr-entity-info [entity]=\\\"entity$ | async\\\"></vdr-entity-info>\\r\\n            <clr-toggle-wrapper *vdrIfPermissions=\\\"'UpdatePromotion'\\\">\\r\\n                <input type=\\\"checkbox\\\" clrToggle name=\\\"enabled\\\" [formControl]=\\\"detailForm.get(['enabled'])\\\" />\\r\\n                <label>{{ 'common.enabled' | translate }}</label>\\r\\n            </clr-toggle-wrapper>\\r\\n        </div>\\r\\n    </vdr-ab-left>\\r\\n\\r\\n    <vdr-ab-right>\\r\\n        <vdr-action-bar-items locationId=\\\"promotion-detail\\\"></vdr-action-bar-items>\\r\\n        <button\\r\\n            class=\\\"btn btn-primary\\\"\\r\\n            *ngIf=\\\"isNew$ | async; else updateButton\\\"\\r\\n            (click)=\\\"create()\\\"\\r\\n            [disabled]=\\\"!saveButtonEnabled()\\\"\\r\\n        >\\r\\n            {{ 'common.create' | translate }}\\r\\n        </button>\\r\\n        <ng-template #updateButton>\\r\\n            <button\\r\\n                class=\\\"btn btn-primary\\\"\\r\\n                (click)=\\\"save()\\\"\\r\\n                *vdrIfPermissions=\\\"'UpdatePromotion'\\\"\\r\\n                [disabled]=\\\"!saveButtonEnabled()\\\"\\r\\n            >\\r\\n                {{ 'common.update' | translate }}\\r\\n            </button>\\r\\n        </ng-template>\\r\\n    </vdr-ab-right>\\r\\n</vdr-action-bar>\\r\\n\\r\\n<form class=\\\"form\\\" [formGroup]=\\\"detailForm\\\">\\r\\n    <vdr-form-field [label]=\\\"'common.name' | translate\\\" for=\\\"name\\\">\\r\\n        <input\\r\\n            id=\\\"name\\\"\\r\\n            [readonly]=\\\"!('UpdatePromotion' | hasPermission)\\\"\\r\\n            type=\\\"text\\\"\\r\\n            formControlName=\\\"name\\\"\\r\\n        />\\r\\n    </vdr-form-field>\\r\\n    <vdr-form-field [label]=\\\"'marketing.starts-at' | translate\\\" for=\\\"startsAt\\\">\\r\\n        <vdr-datetime-picker formControlName=\\\"startsAt\\\"></vdr-datetime-picker>\\r\\n    </vdr-form-field>\\r\\n    <vdr-form-field [label]=\\\"'marketing.ends-at' | translate\\\" for=\\\"endsAt\\\">\\r\\n        <vdr-datetime-picker formControlName=\\\"endsAt\\\"></vdr-datetime-picker>\\r\\n    </vdr-form-field>\\r\\n    <vdr-form-field [label]=\\\"'marketing.coupon-code' | translate\\\" for=\\\"couponCode\\\">\\r\\n        <input\\r\\n            id=\\\"couponCode\\\"\\r\\n            [readonly]=\\\"!('UpdatePromotion' | hasPermission)\\\"\\r\\n            type=\\\"text\\\"\\r\\n            formControlName=\\\"couponCode\\\"\\r\\n        />\\r\\n    </vdr-form-field>\\r\\n    <vdr-form-field [label]=\\\"'marketing.per-customer-limit' | translate\\\" for=\\\"perCustomerUsageLimit\\\">\\r\\n        <input\\r\\n            id=\\\"perCustomerUsageLimit\\\"\\r\\n            [readonly]=\\\"!('UpdatePromotion' | hasPermission)\\\"\\r\\n            type=\\\"number\\\"\\r\\n            min=\\\"1\\\"\\r\\n            max=\\\"999\\\"\\r\\n            formControlName=\\\"perCustomerUsageLimit\\\"\\r\\n        />\\r\\n    </vdr-form-field>\\r\\n    <section formGroupName=\\\"customFields\\\" *ngIf=\\\"customFields.length\\\">\\r\\n        <label>{{ 'common.custom-fields' | translate }}</label>\\r\\n        <vdr-tabbed-custom-fields\\r\\n            entityName=\\\"Promotion\\\"\\r\\n            [customFields]=\\\"customFields\\\"\\r\\n            [customFieldsFormGroup]=\\\"detailForm.get('customFields')\\\"\\r\\n            [readonly]=\\\"!('UpdatePromotion' | hasPermission)\\\"\\r\\n        ></vdr-tabbed-custom-fields>\\r\\n    </section>\\r\\n\\r\\n    <vdr-custom-detail-component-host\\r\\n        locationId=\\\"promotion-detail\\\"\\r\\n        [entity$]=\\\"entity$\\\"\\r\\n        [detailForm]=\\\"detailForm\\\"\\r\\n    ></vdr-custom-detail-component-host>\\r\\n\\r\\n    <div class=\\\"clr-row\\\">\\r\\n        <div class=\\\"clr-col\\\" formArrayName=\\\"conditions\\\">\\r\\n            <label class=\\\"clr-control-label\\\">{{ 'marketing.conditions' | translate }}</label>\\r\\n            <ng-container *ngFor=\\\"let condition of conditions; index as i\\\">\\r\\n                <vdr-configurable-input\\r\\n                    (remove)=\\\"removeCondition($event)\\\"\\r\\n                    [position]=\\\"i\\\"\\r\\n                    [readonly]=\\\"!('UpdatePromotion' | hasPermission)\\\"\\r\\n                    [operation]=\\\"condition\\\"\\r\\n                    [operationDefinition]=\\\"getConditionDefinition(condition)\\\"\\r\\n                    [formControlName]=\\\"i\\\"\\r\\n                ></vdr-configurable-input>\\r\\n            </ng-container>\\r\\n\\r\\n            <div>\\r\\n                <vdr-dropdown *vdrIfPermissions=\\\"'UpdatePromotion'\\\">\\r\\n                    <button class=\\\"btn btn-outline\\\" vdrDropdownTrigger>\\r\\n                        <clr-icon shape=\\\"plus\\\"></clr-icon>\\r\\n                        {{ 'marketing.add-condition' | translate }}\\r\\n                    </button>\\r\\n                    <vdr-dropdown-menu vdrPosition=\\\"bottom-left\\\">\\r\\n                        <button\\r\\n                            *ngFor=\\\"let condition of getAvailableConditions()\\\"\\r\\n                            type=\\\"button\\\"\\r\\n                            vdrDropdownItem\\r\\n                            class=\\\"item-wrap\\\"\\r\\n                            (click)=\\\"addCondition(condition)\\\"\\r\\n                        >\\r\\n                            {{ condition.description }}\\r\\n                        </button>\\r\\n                    </vdr-dropdown-menu>\\r\\n                </vdr-dropdown>\\r\\n            </div>\\r\\n        </div>\\r\\n        <div class=\\\"clr-col\\\" formArrayName=\\\"actions\\\">\\r\\n            <label class=\\\"clr-control-label\\\">{{ 'marketing.actions' | translate }}</label>\\r\\n            <vdr-configurable-input\\r\\n                *ngFor=\\\"let action of actions; index as i\\\"\\r\\n                (remove)=\\\"removeAction($event)\\\"\\r\\n                [position]=\\\"i\\\"\\r\\n                [operation]=\\\"action\\\"\\r\\n                [readonly]=\\\"!('UpdatePromotion' | hasPermission)\\\"\\r\\n                [operationDefinition]=\\\"getActionDefinition(action)\\\"\\r\\n                [formControlName]=\\\"i\\\"\\r\\n            ></vdr-configurable-input>\\r\\n            <div>\\r\\n                <vdr-dropdown *vdrIfPermissions=\\\"'UpdatePromotion'\\\">\\r\\n                    <button class=\\\"btn btn-outline\\\" vdrDropdownTrigger>\\r\\n                        <clr-icon shape=\\\"plus\\\"></clr-icon>\\r\\n                        {{ 'marketing.add-action' | translate }}\\r\\n                    </button>\\r\\n                    <vdr-dropdown-menu vdrPosition=\\\"bottom-left\\\">\\r\\n                        <button\\r\\n                            *ngFor=\\\"let action of getAvailableActions()\\\"\\r\\n                            type=\\\"button\\\"\\r\\n                            vdrDropdownItem\\r\\n                            class=\\\"item-wrap\\\"\\r\\n                            (click)=\\\"addAction(action)\\\"\\r\\n                        >\\r\\n                            {{ action.description }}\\r\\n                        </button>\\r\\n                    </vdr-dropdown-menu>\\r\\n                </vdr-dropdown>\\r\\n            </div>\\r\\n        </div>\\r\\n    </div>\\r\\n</form>\\r\\n\",\n                changeDetection: ChangeDetectionStrategy.OnPush,\n                styles: [\".item-wrap{white-space:normal}\\n\"]\n            }]\n    }], function () { return [{ type: ɵngcc1.Router }, { type: ɵngcc1.ActivatedRoute }, { type: ɵngcc2.ServerConfigService }, { type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc2.DataService }, { type: ɵngcc3.FormBuilder }, { type: ɵngcc2.NotificationService }]; }, null); })();\n\nclass PromotionListComponent extends BaseListComponent {\r\n    constructor(dataService, router, route, notificationService, modalService) {\r\n        super(router, route);\r\n        this.dataService = dataService;\r\n        this.notificationService = notificationService;\r\n        this.modalService = modalService;\r\n        this.searchForm = new FormGroup({\r\n            name: new FormControl(''),\r\n            couponCode: new FormControl(''),\r\n        });\r\n        super.setQueryFn((...args) => this.dataService.promotion.getPromotions(...args).refetchOnChannelChange(), data => data.promotions, (skip, take) => this.createQueryOptions(skip, take, this.searchForm.value));\r\n    }\r\n    ngOnInit() {\r\n        super.ngOnInit();\r\n        merge(this.searchForm.valueChanges.pipe(debounceTime(250)), this.route.queryParamMap)\r\n            .pipe(takeUntil(this.destroy$))\r\n            .subscribe(val => {\r\n            if (!val.params) {\r\n                this.setPageNumber(1);\r\n            }\r\n            this.refresh();\r\n        });\r\n    }\r\n    deletePromotion(promotionId) {\r\n        this.modalService\r\n            .dialog({\r\n            title: marker('catalog.confirm-delete-promotion'),\r\n            buttons: [\r\n                { type: 'secondary', label: marker('common.cancel') },\r\n                { type: 'danger', label: marker('common.delete'), returnValue: true },\r\n            ],\r\n        })\r\n            .pipe(switchMap(response => response ? this.dataService.promotion.deletePromotion(promotionId) : EMPTY))\r\n            .subscribe(() => {\r\n            this.notificationService.success(marker('common.notify-delete-success'), {\r\n                entity: 'Promotion',\r\n            });\r\n            this.refresh();\r\n        }, err => {\r\n            this.notificationService.error(marker('common.notify-delete-error'), {\r\n                entity: 'Promotion',\r\n            });\r\n        });\r\n    }\r\n    createQueryOptions(skip, take, searchForm) {\r\n        const filter = {};\r\n        if (searchForm.couponCode) {\r\n            filter.couponCode = { contains: searchForm.couponCode };\r\n        }\r\n        if (searchForm.name) {\r\n            filter.name = { contains: searchForm.name };\r\n        }\r\n        return {\r\n            options: {\r\n                skip,\r\n                take,\r\n                filter,\r\n            },\r\n        };\r\n    }\r\n}\nPromotionListComponent.ɵfac = function PromotionListComponent_Factory(t) { return new (t || PromotionListComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc2.DataService), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.Router), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.ActivatedRoute), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.NotificationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.ModalService)); };\nPromotionListComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: PromotionListComponent, selectors: [[\"vdr-promotion-list\"]], features: [ɵngcc0.ɵɵInheritDefinitionFeature], decls: 31, vars: 32, consts: [[1, \"search-form\", 3, \"formGroup\"], [\"type\", \"text\", \"formControlName\", \"name\", 1, \"search-input\", 3, \"placeholder\"], [\"type\", \"text\", \"formControlName\", \"couponCode\", 1, \"search-input\", 3, \"placeholder\"], [\"locationId\", \"promotion-list\"], [\"class\", \"btn btn-primary\", 3, \"routerLink\", 4, \"vdrIfPermissions\"], [3, \"items\", \"itemsPerPage\", \"totalItems\", \"currentPage\", \"pageChange\", \"itemsPerPageChange\"], [1, \"btn\", \"btn-primary\", 3, \"routerLink\"], [\"shape\", \"plus\"], [1, \"left\", \"align-middle\"], [4, \"ngIf\"], [1, \"align-middle\"], [1, \"right\", \"align-middle\"], [\"iconShape\", \"edit\", 3, \"label\", \"linkTo\"], [\"type\", \"button\", \"vdrDropdownTrigger\", \"\", 1, \"btn\", \"btn-link\", \"btn-sm\"], [\"shape\", \"caret down\"], [\"vdrPosition\", \"bottom-right\"], [\"type\", \"button\", \"vdrDropdownItem\", \"\", 1, \"delete-button\", 3, \"disabled\", \"click\"], [\"shape\", \"trash\", 1, \"is-danger\"]], template: function PromotionListComponent_Template(rf, ctx) { if (rf & 1) {\n        ɵngcc0.ɵɵelementStart(0, \"vdr-action-bar\");\n        ɵngcc0.ɵɵelementStart(1, \"vdr-ab-left\");\n        ɵngcc0.ɵɵelementStart(2, \"form\", 0);\n        ɵngcc0.ɵɵelement(3, \"input\", 1);\n        ɵngcc0.ɵɵpipe(4, \"translate\");\n        ɵngcc0.ɵɵelement(5, \"input\", 2);\n        ɵngcc0.ɵɵpipe(6, \"translate\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(7, \"vdr-ab-right\");\n        ɵngcc0.ɵɵelement(8, \"vdr-action-bar-items\", 3);\n        ɵngcc0.ɵɵtemplate(9, PromotionListComponent_a_9_Template, 4, 5, \"a\", 4);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(10, \"vdr-data-table\", 5);\n        ɵngcc0.ɵɵlistener(\"pageChange\", function PromotionListComponent_Template_vdr_data_table_pageChange_10_listener($event) { return ctx.setPageNumber($event); })(\"itemsPerPageChange\", function PromotionListComponent_Template_vdr_data_table_itemsPerPageChange_10_listener($event) { return ctx.setItemsPerPage($event); });\n        ɵngcc0.ɵɵpipe(11, \"async\");\n        ɵngcc0.ɵɵpipe(12, \"async\");\n        ɵngcc0.ɵɵpipe(13, \"async\");\n        ɵngcc0.ɵɵpipe(14, \"async\");\n        ɵngcc0.ɵɵelementStart(15, \"vdr-dt-column\");\n        ɵngcc0.ɵɵtext(16);\n        ɵngcc0.ɵɵpipe(17, \"translate\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(18, \"vdr-dt-column\");\n        ɵngcc0.ɵɵtext(19);\n        ɵngcc0.ɵɵpipe(20, \"translate\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(21, \"vdr-dt-column\");\n        ɵngcc0.ɵɵtext(22);\n        ɵngcc0.ɵɵpipe(23, \"translate\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(24, \"vdr-dt-column\");\n        ɵngcc0.ɵɵtext(25);\n        ɵngcc0.ɵɵpipe(26, \"translate\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelement(27, \"vdr-dt-column\");\n        ɵngcc0.ɵɵelement(28, \"vdr-dt-column\");\n        ɵngcc0.ɵɵelement(29, \"vdr-dt-column\");\n        ɵngcc0.ɵɵtemplate(30, PromotionListComponent_ng_template_30_Template, 27, 26, \"ng-template\");\n        ɵngcc0.ɵɵelementEnd();\n    } if (rf & 2) {\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"formGroup\", ctx.searchForm);\n        ɵngcc0.ɵɵadvance(1);\n        ɵngcc0.ɵɵproperty(\"placeholder\", ɵngcc0.ɵɵpipeBind1(4, 12, \"marketing.search-by-name\"));\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"placeholder\", ɵngcc0.ɵɵpipeBind1(6, 14, \"marketing.search-by-coupon-code\"));\n        ɵngcc0.ɵɵadvance(4);\n        ɵngcc0.ɵɵproperty(\"vdrIfPermissions\", \"CreatePromotion\");\n        ɵngcc0.ɵɵadvance(1);\n        ɵngcc0.ɵɵproperty(\"items\", ɵngcc0.ɵɵpipeBind1(11, 16, ctx.items$))(\"itemsPerPage\", ɵngcc0.ɵɵpipeBind1(12, 18, ctx.itemsPerPage$))(\"totalItems\", ɵngcc0.ɵɵpipeBind1(13, 20, ctx.totalItems$))(\"currentPage\", ɵngcc0.ɵɵpipeBind1(14, 22, ctx.currentPage$));\n        ɵngcc0.ɵɵadvance(6);\n        ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(17, 24, \"common.name\"));\n        ɵngcc0.ɵɵadvance(3);\n        ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(20, 26, \"marketing.coupon-code\"));\n        ɵngcc0.ɵɵadvance(3);\n        ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(23, 28, \"marketing.starts-at\"));\n        ɵngcc0.ɵɵadvance(3);\n        ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(26, 30, \"marketing.ends-at\"));\n    } }, directives: [ɵngcc2.ActionBarComponent, ɵngcc2.ActionBarLeftComponent, ɵngcc3.ɵNgNoValidate, ɵngcc3.NgControlStatusGroup, ɵngcc3.FormGroupDirective, ɵngcc2.FormFieldControlDirective, ɵngcc3.DefaultValueAccessor, ɵngcc3.NgControlStatus, ɵngcc3.FormControlName, ɵngcc2.ActionBarRightComponent, ɵngcc2.ActionBarItemsComponent, ɵngcc2.IfPermissionsDirective, ɵngcc2.DataTableComponent, ɵngcc2.DataTableColumnComponent, ɵngcc1.RouterLinkWithHref, ɵngcc5.ClrIconCustomTag, ɵngcc4.NgIf, ɵngcc2.TableRowActionComponent, ɵngcc2.DropdownComponent, ɵngcc2.DropdownTriggerDirective, ɵngcc2.DropdownMenuComponent, ɵngcc2.DropdownItemDirective, ɵngcc2.ChipComponent], pipes: [ɵngcc6.TranslatePipe, ɵngcc4.AsyncPipe, ɵngcc2.LocaleDatePipe, ɵngcc2.HasPermissionPipe], styles: [\".search-form[_ngcontent-%COMP%]{padding:0}.search-input[_ngcontent-%COMP%]{margin:6px 8px 0 0;min-width:200px}\"], changeDetection: 0 });\r\nPromotionListComponent.ctorParameters = () => [\r\n    { type: DataService },\r\n    { type: Router },\r\n    { type: ActivatedRoute },\r\n    { type: NotificationService },\r\n    { type: ModalService }\r\n];\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(PromotionListComponent, [{\n        type: Component,\n        args: [{\n                selector: 'vdr-promotion-list',\n                template: \"<vdr-action-bar>\\r\\n    <vdr-ab-left>\\r\\n        <form class=\\\"search-form\\\" [formGroup]=\\\"searchForm\\\">\\r\\n            <input\\r\\n                type=\\\"text\\\"\\r\\n                formControlName=\\\"name\\\"\\r\\n                [placeholder]=\\\"'marketing.search-by-name' | translate\\\"\\r\\n                class=\\\"search-input\\\"\\r\\n            />\\r\\n            <input\\r\\n                type=\\\"text\\\"\\r\\n                formControlName=\\\"couponCode\\\"\\r\\n                [placeholder]=\\\"'marketing.search-by-coupon-code' | translate\\\"\\r\\n                class=\\\"search-input\\\"\\r\\n            />\\r\\n        </form>\\r\\n    </vdr-ab-left>\\r\\n    <vdr-ab-right>\\r\\n        <vdr-action-bar-items locationId=\\\"promotion-list\\\"></vdr-action-bar-items>\\r\\n        <a class=\\\"btn btn-primary\\\"\\r\\n           *vdrIfPermissions=\\\"'CreatePromotion'\\\"\\r\\n           [routerLink]=\\\"['./create']\\\">\\r\\n            <clr-icon shape=\\\"plus\\\"></clr-icon>\\r\\n            {{ 'marketing.create-new-promotion' | translate }}\\r\\n        </a>\\r\\n    </vdr-ab-right>\\r\\n</vdr-action-bar>\\r\\n\\r\\n<vdr-data-table\\r\\n    [items]=\\\"items$ | async\\\"\\r\\n    [itemsPerPage]=\\\"itemsPerPage$ | async\\\"\\r\\n    [totalItems]=\\\"totalItems$ | async\\\"\\r\\n    [currentPage]=\\\"currentPage$ | async\\\"\\r\\n    (pageChange)=\\\"setPageNumber($event)\\\"\\r\\n    (itemsPerPageChange)=\\\"setItemsPerPage($event)\\\"\\r\\n>\\r\\n    <vdr-dt-column>{{ 'common.name' | translate }}</vdr-dt-column>\\r\\n    <vdr-dt-column>{{ 'marketing.coupon-code' | translate }}</vdr-dt-column>\\r\\n    <vdr-dt-column>{{ 'marketing.starts-at' | translate }}</vdr-dt-column>\\r\\n    <vdr-dt-column>{{ 'marketing.ends-at' | translate }}</vdr-dt-column>\\r\\n    <vdr-dt-column></vdr-dt-column>\\r\\n    <vdr-dt-column></vdr-dt-column>\\r\\n    <vdr-dt-column></vdr-dt-column>\\r\\n    <ng-template let-promotion=\\\"item\\\">\\r\\n        <td class=\\\"left align-middle\\\">{{ promotion.name }}</td>\\r\\n        <td class=\\\"left align-middle\\\">\\r\\n            <vdr-chip *ngIf=\\\"promotion.couponCode\\\">\\r\\n                {{ promotion.couponCode }}\\r\\n            </vdr-chip>\\r\\n        </td>\\r\\n        <td class=\\\"left align-middle\\\">{{ promotion.startsAt | localeDate: 'longDate' }}</td>\\r\\n        <td class=\\\"left align-middle\\\">{{ promotion.endsAt | localeDate: 'longDate' }}</td>\\r\\n        <td class=\\\"align-middle\\\">\\r\\n            <vdr-chip *ngIf=\\\"!promotion.enabled\\\">{{ 'common.disabled' | translate }}</vdr-chip>\\r\\n        </td>\\r\\n        <td class=\\\"right align-middle\\\">\\r\\n            <vdr-table-row-action\\r\\n                iconShape=\\\"edit\\\"\\r\\n                [label]=\\\"'common.edit' | translate\\\"\\r\\n                [linkTo]=\\\"['./', promotion.id]\\\"\\r\\n            ></vdr-table-row-action>\\r\\n        </td>\\r\\n        <td class=\\\"right align-middle\\\">\\r\\n            <vdr-dropdown>\\r\\n                <button type=\\\"button\\\" class=\\\"btn btn-link btn-sm\\\" vdrDropdownTrigger>\\r\\n                    {{ 'common.actions' | translate }}\\r\\n                    <clr-icon shape=\\\"caret down\\\"></clr-icon>\\r\\n                </button>\\r\\n                <vdr-dropdown-menu vdrPosition=\\\"bottom-right\\\">\\r\\n                    <button\\r\\n                        type=\\\"button\\\"\\r\\n                        class=\\\"delete-button\\\"\\r\\n                        (click)=\\\"deletePromotion(promotion.id)\\\"\\r\\n                        [disabled]=\\\"!('DeletePromotion' | hasPermission)\\\"\\r\\n                        vdrDropdownItem\\r\\n                    >\\r\\n                        <clr-icon shape=\\\"trash\\\" class=\\\"is-danger\\\"></clr-icon>\\r\\n                        {{ 'common.delete' | translate }}\\r\\n                    </button>\\r\\n                </vdr-dropdown-menu>\\r\\n            </vdr-dropdown>\\r\\n        </td>\\r\\n    </ng-template>\\r\\n</vdr-data-table>\\r\\n\",\n                changeDetection: ChangeDetectionStrategy.OnPush,\n                styles: [\".search-form{padding:0}.search-input{margin:6px 8px 0 0;min-width:200px}\\n\"]\n            }]\n    }], function () { return [{ type: ɵngcc2.DataService }, { type: ɵngcc1.Router }, { type: ɵngcc1.ActivatedRoute }, { type: ɵngcc2.NotificationService }, { type: ɵngcc2.ModalService }]; }, null); })();\n\n/**\r\n * Resolves the id from the path into a Customer entity.\r\n */\r\nclass PromotionResolver extends BaseEntityResolver {\r\n    constructor(router, dataService) {\r\n        super(router, {\r\n            __typename: 'Promotion',\r\n            id: '',\r\n            createdAt: '',\r\n            updatedAt: '',\r\n            name: '',\r\n            enabled: false,\r\n            conditions: [],\r\n            actions: [],\r\n        }, id => dataService.promotion.getPromotion(id).mapStream(data => data.promotion));\r\n    }\r\n}\nPromotionResolver.ɵfac = function PromotionResolver_Factory(t) { return new (t || PromotionResolver)(ɵngcc0.ɵɵinject(ɵngcc1.Router), ɵngcc0.ɵɵinject(ɵngcc2.DataService)); };\r\nPromotionResolver.ɵprov = i0.ɵɵdefineInjectable({ factory: function PromotionResolver_Factory() { return new PromotionResolver(i0.ɵɵinject(i1.Router), i0.ɵɵinject(i2.DataService)); }, token: PromotionResolver, providedIn: \"root\" });\r\nPromotionResolver.ctorParameters = () => [\r\n    { type: Router },\r\n    { type: DataService }\r\n];\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(PromotionResolver, [{\n        type: Injectable,\n        args: [{\n                providedIn: 'root'\n            }]\n    }], function () { return [{ type: ɵngcc1.Router }, { type: ɵngcc2.DataService }]; }, null); })();\n\nconst ɵ0 = {\r\n    breadcrumb: marker('breadcrumb.promotions'),\r\n}, ɵ1 = {\r\n    breadcrumb: promotionBreadcrumb,\r\n};\r\nconst marketingRoutes = [\r\n    {\r\n        path: 'promotions',\r\n        component: PromotionListComponent,\r\n        data: ɵ0,\r\n    },\r\n    {\r\n        path: 'promotions/:id',\r\n        component: PromotionDetailComponent,\r\n        resolve: createResolveData(PromotionResolver),\r\n        canDeactivate: [CanDeactivateDetailGuard],\r\n        data: ɵ1,\r\n    },\r\n];\r\nfunction promotionBreadcrumb(data, params) {\r\n    return detailBreadcrumb({\r\n        entity: data.entity,\r\n        id: params.id,\r\n        breadcrumbKey: 'breadcrumb.promotions',\r\n        getName: promotion => promotion.name,\r\n        route: 'promotions',\r\n    });\r\n}\n\nclass MarketingModule {\r\n}\nMarketingModule.ɵfac = function MarketingModule_Factory(t) { return new (t || MarketingModule)(); };\nMarketingModule.ɵmod = /*@__PURE__*/ ɵngcc0.ɵɵdefineNgModule({ type: MarketingModule });\nMarketingModule.ɵinj = /*@__PURE__*/ ɵngcc0.ɵɵdefineInjector({ imports: [[SharedModule, RouterModule.forChild(marketingRoutes)]] });\n(function () { (typeof ngDevMode === \"undefined\" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(MarketingModule, [{\n        type: NgModule,\n        args: [{\n                imports: [SharedModule, RouterModule.forChild(marketingRoutes)],\n                declarations: [PromotionListComponent, PromotionDetailComponent]\n            }]\n    }], null, null); })();\n(function () { (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(MarketingModule, { declarations: function () { return [PromotionListComponent, PromotionDetailComponent]; }, imports: function () { return [SharedModule, ɵngcc1.RouterModule]; } }); })();\n\n// This file was generated by the build-public-api.ts script\n\n/**\r\n * Generated bundle index. Do not edit.\r\n */\n\nexport { MarketingModule, PromotionDetailComponent, PromotionListComponent, PromotionResolver, marketingRoutes, promotionBreadcrumb, ɵ0, ɵ1 };\n\n"]}